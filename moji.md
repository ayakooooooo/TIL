# 文字コード
文字をコンピューターで表現する際にどのようなバイト表現にするかを定めるもの  
文字集合　→　符号化方式  
文字に割り振った文字集合と、文字集合をバイト列に変換する符号化方式の二つでできてる  

# 文字集合 
符号化文字集合(CCS:Coded Caracter Set)、キャラクタセット とも呼ぶ
文字に番号を割り振り  
文字集合として JIS X 0208 や Unicode  
文字に「群・面・区・点」の番号  
例えば文字の「あ」は、JIS X 0208 では「4区1点」、Unicodeでは「0面48区66点」の番号  

# 符号化方式  
文字符号化方式(CES:Character Encoding Scheme)、エンコーディングルール とも呼ぶ  
文字集合で定義した「群・面・区・点」の番号を、どのようなバイト列に変換するかのルールを決める  
JIS X 0208 を符号化する方式としては、ISO-2022-JP(俗にいうJISコード)、Shift_JIS、EUC など、  
Unicode を符号化する方式としては、UTF-8, UTF-16 などがある  

- 半角系
- 制御文字
- JIS系
- Unicode系

## JIS系のなかの、Shift_JIS (シフトJIS)  
Windows 系で使用される符号化方式  
## Unicode  
世界中の文字を一つのコード体系で表現しようとして制定されたもの  
例えば日本語の「あ」は「0面48区66点」と定義  
## UTF-8  
Unicode系で一番利用されている符号化方式  

***
なんで文字コードが必要なのか？  
コンピューターはデータを数値でしか扱えないため、文字も数値で扱わなければならない。  
そのため、文字を表示するには文字コードが必要。  
***
設定された文字コードが違うことで、  
文字が割り当てられていない数値が渡されたり、意図しない文字として認識されることが原因。  
「HTMLファイル自体の文字コードと、ブラウザが解釈した文字コードが異なるとき」に文字化けが起きる  
***
# 改行コード  
コンピュータなどで改行を現したコード  
人間は目で改行しているか認識できますが、PC側はコードで認識  

改行コードは主に２種類  
- ラインフィードは一般的にLF  
- キャリッジリターンは一般的にCR  
- CRとLFを合わせたCR＋LFも  

CRLF　：　↵ ( ← + ↓ )  
CR　　：　←  
LF　　：　↓  
***
［プラットフォーム編］複数OSを利用するときは改行コードに気をつけなくてはいけない  
たとえ，サービスを提供するサーバー群がUNIX系OSで統一されていても，  
管理用端末や開発用端末のOSはWindowsというケースが多い。  
異なる種類のOSで作業をするにあたり，気をつけなくてはいけないことの一つが，OS間での改行コードの違いだ。  
改行コードは，UNIX系OSでは「LF」，Windowsでは「CR+LF」となる（CR：Carriage Return（0x0A），LF：Line Feed（0x0D））。  

　端末間のファイル転送時に，シェル・スクリプトやperlスクリプトをテキスト・ファイルのまま転送していないだろうか。  
 これらのスクリプトは，可読性のあるテキスト形式で記載されるが，  
 実行時にはプログラムが翻訳して実行されるため，改行コードが異なれば実行できないことがある。  
 ***
 OS	      コード表記	 16進表記	  10進表記
UNIX	     <LF>	      0A	      10
Windows	  <CR><LF>	 0D 0A	   13 10
Macintosh	<CR>	      0D	      13
***
# 転送前に変換しておく方法
最近のテキストエディタには、保存時に漢字コードや改行コードを直接指定できるものがあります。  
FTPソフトに変換してもらう方法がうまくいかない場合は、  
あらかじめテキストエディタで改行コードを相手のOSにあわせて保存し、  
その後、FTPソフトの[バイナリモード(Rawモード)]で転送するようにしてください。  
***
FTP (File Transfer Protocol、ファイル転送プロトコル) は、  
コンピュータ間でファイルを転送するために使用される標準的なインターネットプロトコル  
***
絵文字を除外し、UTF-8とShift JISの文字コードで半角と全角の文字を混在させる方法を示します。絵文字の除外には、Unicodeの基本多言語面（BMP）内の文字のみを許可します。  
```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>UTF-8とShift JISの文字コード混在入力</title>
</head>
<body>
    <h2>UTF-8とShift JISの文字コード混在入力</h2>
    <form method="post">
        <label for="inputData">入力してください:</label>
        <input type="text" id="inputData" name="inputData" required pattern="[^\x{10000}-\x{10FFFF}]">
        <button type="submit">送信</button>
    </form>

    <?php
    if ($_SERVER["REQUEST_METHOD"] == "POST") {
        $inputData = $_POST["inputData"];

        // UTF-8に変換して表示
        echo "<p>UTF-8: $inputData</p>";

        // Shift JISに変換して表示
        $sjis_data = mb_convert_encoding($inputData, "SJIS", "UTF-8");
        echo "<p>Shift JIS: $sjis_data</p>";
    }
    ?>
</body>
</html>
```
このコードでは、入力フィールドにpattern="[^\x{10000}-\x{10FFFF}]"を追加して、Unicodeの基本多言語面（BMP）外の文字（絵文字を含む）を除外します。これにより、ユーザーは絵文字を入力できなくなります。  
***
 
